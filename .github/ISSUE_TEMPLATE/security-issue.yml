name: "üîí Security Issue"
description: Reporta vulnerabilidades o problemas de seguridad (CONFIDENCIAL)
labels: ["security", "vulnerability", "urgent"]
body:
  - type: markdown
    attributes:
      value: |
        ## üîí Reporte de Seguridad
        **IMPORTANTE:** Si es una vulnerabilidad cr√≠tica, considera reportarla de forma privada.
        
        Este template es para problemas de seguridad en la API backend.
        Proporciona detalles t√©cnicos pero evita informaci√≥n sensible.

  - type: dropdown
    id: security-category
    attributes:
      label: Tipo de problema de seguridad
      description: ¬øQu√© tipo de vulnerabilidad o problema de seguridad identificaste?
      options:
        - Authentication/Authorization
        - SQL Injection
        - XSS (Cross-Site Scripting)
        - CSRF (Cross-Site Request Forgery)
        - Information Disclosure
        - Input Validation
        - JWT Token Issues
        - CORS Configuration
        - Rate Limiting
        - Dependency Vulnerability
        - Environment/Configuration
        - Other
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: Severidad estimada
      description: ¬øQu√© tan cr√≠tico consideras este problema?
      options:
        - Critical (Immediate attention required)
        - High (Should be fixed soon)
        - Medium (Should be addressed)
        - Low (Minor security concern)
        - Info (Security improvement suggestion)
    validations:
      required: true

  - type: textarea
    id: vulnerability-description
    attributes:
      label: Descripci√≥n de la vulnerabilidad
      description: |
        Describe el problema de seguridad sin incluir informaci√≥n sensible
      placeholder: |
        El endpoint /api/users permite acceso sin autenticaci√≥n adecuada,
        exponiendo informaci√≥n de usuarios que deber√≠a estar protegida.
    validations:
      required: true

  - type: textarea
    id: affected-endpoints
    attributes:
      label: Endpoints o componentes afectados
      description: |
        ¬øQu√© partes de la API est√°n afectadas?
      placeholder: |
        - GET /api/users (expone emails de usuarios)
        - POST /api/admin/users (sin verificaci√≥n de rol admin)
        - JWT middleware en /src/middleware/auth.ts
    validations:
      required: true

  - type: textarea
    id: potential-impact
    attributes:
      label: Impacto potencial
      description: |
        ¬øQu√© podr√≠a ocurrir si se explota esta vulnerabilidad?
      placeholder: |
        - Acceso no autorizado a datos de usuarios
        - Escalaci√≥n de privilegios
        - Exposici√≥n de informaci√≥n sensible
        - Posible compromiso de la base de datos
    validations:
      required: true

  - type: textarea
    id: reproduction-steps
    attributes:
      label: Pasos para reproducir (si es seguro)
      description: |
        Pasos b√°sicos para reproducir el problema (sin explotar la vulnerabilidad)
      placeholder: |
        1. Hacer request a GET /api/users sin token de autenticaci√≥n
        2. Observar que la API devuelve datos sin verificar permisos
        3. Verificar que emails y datos sensibles son expuestos
    validations:
      required: false

  - type: textarea
    id: code-snippet
    attributes:
      label: C√≥digo relevante (si aplica)
      description: |
        Fragmento de c√≥digo donde se identifica el problema
      placeholder: |
        ```typescript
        // En userController.ts - falta verificaci√≥n de autenticaci√≥n
        async getUsers(req: Request, res: Response) {
          const users = await User.find(); // ‚ùå Sin verificar permisos
          res.json(users); // ‚ùå Expone todos los datos
        }
        ```
    validations:
      required: false

  - type: textarea
    id: suggested-fix
    attributes:
      label: Soluci√≥n sugerida
      description: |
        Si tienes ideas sobre c√≥mo corregir el problema
      placeholder: |
        1. Agregar middleware de autenticaci√≥n al endpoint
        2. Implementar verificaci√≥n de roles/permisos
        3. Filtrar campos sensibles en la respuesta
        4. Agregar rate limiting para prevenir abuso
    validations:
      required: false

  - type: textarea
    id: references
    attributes:
      label: Referencias o recursos
      description: |
        Enlaces a documentaci√≥n, CVEs, o recursos relacionados
      placeholder: |
        - OWASP Top 10: https://owasp.org/www-project-top-ten/
        - JWT Best Practices: https://tools.ietf.org/html/rfc8725
        - Related CVE: CVE-2024-XXXXX
    validations:
      required: false

  - type: checkboxes
    id: security-checklist
    attributes:
      label: Checklist de seguridad
      description: Confirma que has seguido las mejores pr√°cticas de reporte
      options:
        - label: He verificado que esto es realmente un problema de seguridad
          required: true
        - label: No he incluido credenciales reales o informaci√≥n sensible
          required: true
        - label: He considerado el impacto antes de hacer p√∫blico este reporte
          required: true
        - label: He probado en un entorno de desarrollo, no en producci√≥n
          required: false